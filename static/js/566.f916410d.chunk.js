"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[566],{51566:function(e,t,n){n.r(t),n.d(t,{default:function(){return ee}});var r=n(53596),i=n(76566),o=n(94965),a=n(42190),s=n(86698),c=n(66940),l=n(19058),u=n(58054),d=n(30001),p=n(3366),f=n(43493),g=(0,n(83373).tJ)((function(e,t){return{dialogList:[{time:c.time.parse(new Date),messages:[],current:!0,id:"first",top:!0}],value:"",disabled:!1,controller:new AbortController,autoValue:"",autoScroll:!0,fullScreen:!1,createDialog:function(){var n=t(),r=n.dialogList,i=n.controller,o=n.disabled,a=[{time:c.time.parse(new Date),messages:[],current:!0,id:"".concat(Math.random()),top:!0}].concat((0,p.Z)(r.map((function(e){return(0,d.Z)((0,d.Z)({},e),{},{current:!1,top:!1})}))));return o?(i.abort(),e({dialogList:a,disabled:!1})):e({dialogList:a})},updateDialog:function(n){e({dialogList:t().dialogList.map((function(e){return(0,d.Z)((0,d.Z)({},e),n(e))}))})},deleteDialog:function(n){var r=t().dialogList.filter((function(e){return e.id!==n}));r.every((function(e){return!e.current}))&&(r[0].current=!0),e({dialogList:r})},setMessages:function(e){t().updateDialog((function(t){return{messages:t.current?e:t.messages}}))},sendMessage:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t().value;if(n.trim()){var r,i,o=t(),a=o.setMessages,s=o.dialogList.find((function(e){return e.current})).messages,c=new AbortController;e({disabled:!0,controller:c}),a([].concat((0,p.Z)(s),[{content:n,role:"user"}])),setTimeout((function(){a([].concat((0,p.Z)(s),[{content:n,role:"user"},{content:"ai\u601d\u7d22\u4e2d...",role:"assistant"}]))}),700),(r={messages:[].concat((0,p.Z)(s),[{content:n,role:"user"}])},i=c,fetch("/api/all/chatgpt",{method:"POST",headers:{"Content-Type":"application/json"},signal:i.signal,body:JSON.stringify(r)})).then(function(){var t=(0,u.Z)((0,l.Z)().mark((function t(r){var i,o,c,u,d,f,g,h,m;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r.status,o=r.body,200!==i){t.next=22;break}c=new TextDecoder("utf-8"),u=o.getReader(),d="";case 5:return t.next=8,u.read();case 8:if(f=t.sent,g=f.done,h=f.value,!g){t.next=14;break}return e({disabled:!1,value:""}),t.abrupt("break",20);case 14:m=c.decode(h),m.split("data: ").filter((function(e){return e})).forEach((function(e){try{var t=JSON.parse(e);t.choices[0].delta.content&&(d+=t.choices[0].delta.content)}catch(n){}})),a([].concat((0,p.Z)(s),[{content:n,role:"user"},{content:d,role:"assistant"}])),t.next=5;break;case 20:t.next=24;break;case 22:a([].concat((0,p.Z)(s),[{content:n,role:"user"},{content:"",role:"assistant"}])),e({disabled:!1});case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}}}),{name:"chatgpt",partialize:function(e){return{dialogList:e.dialogList}}}),h=(0,f.Ue)(g),m=n(37556),x=n(98110),v=x.ZP.div.withConfig({displayName:"ChatGptWrapper",componentId:"sc-wt6zbk-0"})(["display:flex;"]),b=(0,x.ZP)(v).withConfig({displayName:"ChatGptFullScreenWrapper",componentId:"sc-wt6zbk-1"})(["position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#fff;z-index:999999;padding:20px;overflow:hidden;"]),y=x.ZP.div.withConfig({displayName:"ChatWrapper",componentId:"sc-wt6zbk-2"})(["width:calc(100% - 280px - 50px);display:flex;flex-direction:column;"]),w=x.ZP.div.withConfig({displayName:"HistoryWrapper",componentId:"sc-wt6zbk-3"})(["width:280px;background-color:#001529;text-align:center;padding-top:20px;position:relative;.refresh{position:absolute;right:10px;top:25px;}"]),j=(0,x.ZP)(m.Z).withConfig({displayName:"ToolBarWrapper",componentId:"sc-wt6zbk-4"})(["width:50px;text-align:right;"]),Z=x.ZP.ul.withConfig({displayName:"HistoryList",componentId:"sc-wt6zbk-5"})(["background-color:#001529;text-align:left;padding:20px 10px 0;color:#fff;height:68vh;overflow:auto;margin-top:15px;"]),C=x.ZP.li.withConfig({displayName:"LabelWrapper",componentId:"sc-wt6zbk-6"})(["position:relative;line-height:40px;cursor:pointer;display:flex;border-radius:10px;padding:0 10px;margin-bottom:5px;background-color:",";.name{flex:1;overflow:hidden;margin:0 10px;margin-right:0;white-space:nowrap;position:relative;.zhao{position:absolute;right:0;top:0;width:30px;height:100%;background-image:linear-gradient( to left,var(--ant-primary-color),transparent );}}.action{width:60px;display:flex;justify-content:space-around;position:relative;top:1px;color:#eee;}.ico{font-size:18px !important;&:hover{color:var(--ant-primary-4);}}"],(function(e){return e.active?"var(--ant-primary-color)":"transparent"})),k=x.ZP.div.withConfig({displayName:"InputWrapper",componentId:"sc-wt6zbk-7"})(["padding:10px;padding-bottom:0;padding-right:0;text-align:right;.sendBtn{margin-top:5px;margin-left:10px;}"]),N=x.ZP.div.withConfig({displayName:"MessagesWrapper",componentId:"sc-wt6zbk-8"})(["overflow-y:scroll;padding:20px;",""],(function(e){return e.fullScreen?"flex: 1;":"height: 60vh;"})),S=x.ZP.div.withConfig({displayName:"MessageBubble",componentId:"sc-wt6zbk-9"})(["display:block;padding-left:55px;position:relative;margin-bottom:10px;.content{display:inline-block;max-width:80%;margin-bottom:10px;padding:10px 15px;border-radius:10px;background-color:",";color:",";align-self:",';box-shadow:0 2px 4px rgba(0,0,0,0.15);position:relative;overflow-x:auto;::before{position:absolute;left:-19px;top:6px;height:0;width:0;content:"";border:10px solid rgba(255,255,255,0);border-top:6px solid rgba(255,255,255,0);border-bottom:6px solid rgba(255,255,255,0);border-right-color:',";}.userContent{white-space:pre-wrap;}}.avatar{position:absolute;left:0;border:1px solid #eee;}"],(function(e){return e.isUserMessage?"var(--ant-primary-color)":"#e6e6e6"}),(function(e){return e.isUserMessage?"#fff":"#000"}),(function(e){return e.isUserMessage?"flex-end":"flex-start"}),(function(e){return e.isUserMessage?"var(--ant-primary-color)":"#e6e6e6"})),P=n(34883),z=n(53154),L=n(30092),M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"},I=n(28507),O=function(e,t){return o.createElement(I.Z,(0,d.Z)((0,d.Z)({},e),{},{ref:t,icon:M}))};O.displayName="UserOutlined";var D=o.forwardRef(O),U=n(32518);var E=function(e){var t=e.isUser,n=e.content,i=h().sendMessage;return(0,U.jsxs)(S,{isUserMessage:t,children:[t?(0,U.jsx)(P.C,{icon:(0,U.jsx)(D,{}),className:"avatar",size:"large"}):(0,U.jsx)(P.C,{src:L,className:"avatar",size:"large"}),(0,U.jsx)("div",{className:"content",children:n?t?(0,U.jsx)("div",{className:"userContent",children:n}):(0,U.jsx)(r.UG,{content:n}):(0,U.jsx)(z.ZP,{onClick:function(){return i()},children:"\u6211\u7684cpu\u4e0d\u5c0f\u5fc3\u5e72\u70e7\u4e86...\u70b9\u51fb\u91cd\u65b0\u63d0\u95ee"})})]})},R=n(86045),J=h.setState;var B=function(){var e=h(),t=e.value,n=e.disabled,r=e.controller,i=e.sendMessage;return(0,U.jsxs)(k,{children:[(0,U.jsx)(R.Z.TextArea,{value:t,disabled:n,onChange:function(e){return J({value:e.target.value})},placeholder:"\u4f60\u60f3\u5bf9Ai\u8bf4\u4ec0\u4e48\uff1f\uff08\u652f\u6301\u56de\u8f66\u53d1\u9001\uff0cctrl+\u56de\u8f66\u6362\u884c\uff09",autoSize:{minRows:3,maxRows:6},onKeyDown:function(e){if(13===e.keyCode&&e.ctrlKey&&J({value:t+"\n"}),13===e.keyCode)return i()}}),n&&(0,U.jsx)(z.ZP,{className:"sendBtn",type:"primary",onClick:function(){r.abort(),J({disabled:!1})},children:"\u7ec8\u6b62"}),(0,U.jsx)(z.ZP,{className:"sendBtn",type:"primary",disabled:n,onClick:function(){return i()},children:"\u53d1\u9001"})]})},T=h.setState;var W=function(){var e=h((function(e){return e.dialogList.find((function(e){return e.current})).messages})),t=h(),n=t.autoValue,r=t.autoScroll,a=t.createDialog,l=t.fullScreen,u=t.sendMessage,d=(0,i.kt)(!1),p=(0,s.Z)(d,2),f=p[0],g=p[1],m=(0,o.useRef)(null);return(0,i.b6)((function(){var e=c.url.getParams();return e.q&&(T({autoValue:e.q}),a()),g(),function(){return T({autoValue:""})}})),(0,o.useEffect)((function(){if(r){var e=m.current;e.scrollTo({top:e.scrollHeight-e.clientHeight,behavior:"smooth"})}}),[e,f]),(0,o.useEffect)((function(){n&&u(n)}),[n]),(0,U.jsxs)(y,{children:[(0,U.jsxs)(N,{fullScreen:l,ref:m,children:[(0,U.jsx)(E,{isUser:!1,content:"\n  \u60a8\u597d\uff0c\u6211\u662fchatgpt\u3002\n\n  \u6211\u662f\u4e00\u79cd\u7531OpenAI\u8bad\u7ec3\u7684\u5927\u578b\u8bed\u8a00\u6a21\u578b\u3002\u6211\u7684\u539f\u7406\u662f\u57fa\u4e8eTransformer\u67b6\u6784\uff0c\u901a\u8fc7\u9884\u8bad\u7ec3\u5927\u91cf\u6587\u672c\u6570\u636e\u6765\u5b66\u4e60\u5982\u4f55\u751f\u6210\u4eba\u7c7b\u53ef\u8bfb\u7684\u6587\u672c\uff0c\u7136\u540e\u901a\u8fc7\u63a5\u53d7\u8f93\u5165\u5e76\u751f\u6210\u8f93\u51fa\u6765\u5b9e\u73b0\u5bf9\u8bdd\u3002\n\n  \u6211\u7684\u7528\u9014\u975e\u5e38\u5e7f\u6cdb\uff0c\u53ef\u4ee5\u7528\u4e8e\u81ea\u7136\u8bed\u8a00\u5904\u7406\uff08NLP\uff09\u4efb\u52a1\uff0c\u5982\u5bf9\u8bdd\u751f\u6210\u3001\u95ee\u7b54\u7cfb\u7edf\u3001\u6587\u672c\u751f\u6210\u3001\u5199\u4ee3\u7801\u7b49\u3002\n"}),f&&e.map((function(e,t){return(0,U.jsx)(E,{isUser:t%2===0,content:e.content},e.content+t)}))]}),(0,U.jsx)(B,{})]})},A=n(11713),G=n(22612),H=n(48638);function V(e){var t=e.id,n=e.current,c=e.time,l=h(),u=l.deleteDialog,d=l.updateDialog,p=(0,i.kt)(!1),f=(0,s.Z)(p,3),g=f[0],m=f[1],x=f[2],v=(0,o.useState)(""),b=(0,s.Z)(v,2),y=b[0],w=b[1],j=(0,o.useRef)(null),Z=function(){y&&(d((function(e){return{time:e.id===t?y:e.time}})),x())};return(0,U.jsxs)(C,{onClick:function(){return d((function(e){return{current:e.id===t}}))},active:n,children:[(0,U.jsx)("div",{className:"icon",children:(0,U.jsx)(r.JO,{type:"icon-changyonghuifu",size:16})}),(0,U.jsxs)("div",{className:"name",children:[g?(0,U.jsx)(R.Z,{ref:j,value:y,onChange:function(e){return w(e.target.value)},onPressEnter:Z}):(0,U.jsx)("span",{children:c}),n&&!g&&(0,U.jsx)("div",{className:"zhao"})]}),n&&(0,U.jsx)("ul",{className:"action",children:g?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("li",{children:(0,U.jsx)(G.Z,{className:"ico",onClick:Z})}),(0,U.jsx)("li",{children:(0,U.jsx)(H.Z,{className:"ico",onClick:function(e){e.stopPropagation(),x()}})})]}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("li",{children:(0,U.jsx)(r.JO,{className:"ico",onClick:function(e){e.stopPropagation(),(0,a.flushSync)((function(){m(),w(c)})),j.current.focus({cursor:"end"})},type:"icon-zhongmingming1"})}),(0,U.jsx)("li",{children:(0,U.jsx)(r.JO,{className:"ico",onClick:function(e){e.stopPropagation(),d((function(e){return{top:e.id===t}}))},type:"icon-zhiding_o"})}),(0,U.jsx)("li",{children:(0,U.jsx)(r.JO,{className:"ico",onClick:function(e){e.stopPropagation(),u(t)},type:"icon-shanchu"})})]})})]})}var F=(0,o.memo)(V);function _(){var e=h((function(e){return e.dialogList.sort((function(e){return e.top?-1:1}))})),t=h().createDialog;return(0,U.jsxs)(w,{children:[(0,U.jsx)(z.ZP,{icon:(0,U.jsx)(A.Z,{}),onClick:t,children:"\u65b0\u5efa\u4f1a\u8bdd"}),(0,U.jsx)(Z,{children:e.map((function(e){return(0,U.jsx)(F,(0,d.Z)({},e),e.id)}))})]})}var q=(0,o.memo)(_),K={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},Q=function(e,t){return o.createElement(I.Z,(0,d.Z)((0,d.Z)({},e),{},{ref:t,icon:K}))};Q.displayName="RedoOutlined";var X=o.forwardRef(Q),Y=n(61230),$=function(){var e=h(),t=e.autoScroll,n=e.fullScreen,i=[{icon:(0,U.jsx)(r.JO,{type:"icon-fangda"}),message:"\u5168\u5c4f",type:n?"primary":"default",onClick:function(){return h.setState({fullScreen:!n})}},{icon:(0,U.jsx)(r.JO,{type:"icon-Scroll-Up"}),message:"\u6d88\u606f\u81ea\u52a8\u5411\u4e0a\u6eda\u52a8",type:t?"primary":"default",onClick:function(){return h.setState({autoScroll:!t})}},{icon:(0,U.jsx)(X,{}),message:"\u6e05\u7a7a\u6240\u6709\u5bf9\u8bdd",type:"primary",onClick:function(){localStorage.removeItem("chatgpt"),window.location.reload()}}];return(0,U.jsx)(j,{direction:"vertical",children:i.map((function(e){var t=e.message,n=e.icon,r=e.type,i=e.onClick;return(0,U.jsx)(Y.Z,{title:t,placement:"left",getPopupContainer:function(e){return e},children:(0,U.jsx)(z.ZP,{icon:n,type:r,onClick:i})},t)}))})};var ee=function(){var e=h().fullScreen;return(0,i.b6)((function(){document.title="ChatGpt \xb7 ".concat(globalConfig.title)})),(0,o.useEffect)((function(){document.body.style.overflow=e?"hidden":"visible"}),[e]),e?a.createPortal((0,U.jsxs)(b,{children:[(0,U.jsx)(q,{}),(0,U.jsx)(W,{}),(0,U.jsx)($,{})]}),document.getElementById("root")):(0,U.jsx)(r.hv,{title:"chatgpt",children:(0,U.jsxs)(v,{children:[(0,U.jsx)(q,{}),(0,U.jsx)(W,{}),(0,U.jsx)($,{})]})})}},22612:function(e,t,n){var r=n(30001),i=n(94965),o=n(41986),a=n(28507),s=function(e,t){return i.createElement(a.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:o.Z}))};s.displayName="CheckOutlined",t.Z=i.forwardRef(s)},48638:function(e,t,n){var r=n(30001),i=n(94965),o=n(78833),a=n(28507),s=function(e,t){return i.createElement(a.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:o.Z}))};s.displayName="CloseOutlined",t.Z=i.forwardRef(s)}}]);
//# sourceMappingURL=566.f916410d.chunk.js.map